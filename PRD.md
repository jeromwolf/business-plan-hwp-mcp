# Product Requirements Document (PRD)
# 사업계획서 한글 파일 작성 자동화 MCP

## 1. 제품 개요

### 1.1 제품명
Business Plan HWP MCP (사업계획서 한글 파일 작성 자동화 도구)

### 1.2 제품 목적
AI가 사업계획서 내용을 작성하고 Excel/이미지 데이터를 통합하여 완성된 HWP 파일을 자동 생성하는 MCP(Model Context Protocol) 기반 솔루션

### 1.3 타겟 사용자
- 사업계획서를 자주 작성하는 기업 담당자
- 컨설팅 업체 직원
- 스타트업 창업자
- 정부 지원사업 신청자

## 2. 핵심 기능 요구사항

### 2.1 AI 기반 콘텐츠 생성
- **포맷별 사업계획서 작성**: 정부지원/VC투자/은행대출 포맷
- **AI 섹션별 내용 생성**: Claude가 각 섹션 내용 자동 작성
- **대화형 수정**: 자연어로 내용 수정 요청

### 2.2 데이터 통합 기능
- **Excel → HWP 표 변환**
  - 재무제표, 시장분석 데이터를 HWP 표로 자동 변환
  - 셀 병합, 서식 유지
  - 한글 인코딩 깨짐 방지
- **이미지 삽입**
  - 제품 스크린샷, 차트, 다이어그램 자동 배치
  - 캡션 자동 생성

### 2.3 HWP 파일 생성
- AI 텍스트와 미디어 통합
- 포맷별 템플릿 적용
- 최종 HWP 파일 생성 및 다운로드

### 2.4 템플릿 시스템
- 사업계획서 템플릿 관리
- 섹션별 모듈화된 템플릿
- 변수 치환 시스템 ({{변수명}} 형식)
- 조건부 콘텐츠 삽입

### 2.5 MCP 인터페이스
- Claude Desktop과 직접 통합
- 자연어 명령 처리
- 파일 업로드 지원
- 실시간 피드백

## 3. 기술 요구사항

### 3.1 플랫폼
- **Primary**: macOS (Apple Silicon & Intel)
- **Secondary**: Windows, Linux (추후 지원)

### 3.2 기술 스택
- **Backend**: Node.js + TypeScript
- **MCP Server**: @modelcontextprotocol/sdk
- **HWP Processing**: 
  - hwp-parser (오픈소스 라이브러리)
  - 자체 개발 HWP 생성 모듈
- **Interface**: MCP Protocol (GUI 제거)
- **데이터 처리**: 
  - xlsx (Excel 처리)
  - marked (Markdown 처리)
  - iconv-lite (인코딩 변환)

### 3.3 인코딩 처리
- UTF-8 ↔ EUC-KR 자동 변환
- 특수문자 처리
- 이모지 지원
- 폰트 임베딩

## 4. 비기능 요구사항

### 4.1 성능
- 100페이지 문서 처리: 10초 이내
- 1000행 Excel 데이터 변환: 5초 이내
- 메모리 사용량: 최대 2GB

### 4.2 신뢰성
- 문서 변환 정확도: 99% 이상
- 인코딩 깨짐 발생률: 0.1% 이하
- 자동 백업 기능

### 4.3 사용성
- 3클릭 이내 주요 기능 접근
- 직관적인 UI/UX
- 상세한 에러 메시지
- 다국어 지원 (한국어, 영어)

### 4.4 보안
- 로컬 처리 (클라우드 업로드 없음)
- 민감 정보 마스킹 옵션
- 문서 암호화 지원

## 5. MCP 프로토콜 명세

### 5.1 Resources
```typescript
- hwp://templates/* - HWP 템플릿 접근
- hwp://documents/* - 처리된 문서 접근
- hwp://cache/* - 임시 파일 접근
```

### 5.2 Tools
```typescript
- createBusinessPlan: 포맷별 사업계획서 생성
- insertExcelData: Excel 데이터를 HWP 표로 삽입
- insertImage: 이미지 파일 삽입
- generateHWP: 최종 HWP 파일 생성
```

### 5.3 Prompts
```typescript
- generate_business_plan: 사업계획서 생성
- update_financial_tables: 재무제표 업데이트
- format_document: 문서 서식 정리
```

## 6. 개발 로드맵

### Phase 1: 기초 구현 (2주)
- MCP 서버 기본 구조
- 포맷별 템플릿 시스템
- HWP 생성 엔진

### Phase 2: 핵심 기능 (3주)
- AI 콘텐츠 생성 통합
- Excel → HWP 변환
- 이미지 처리 시스템

### Phase 3: 고급 기능 (2주)
- 멀티미디어 통합
- 인코딩 최적화
- 포맷 검증 시스템

### Phase 4: 테스트 및 배포 (1주)
- 통합 테스트
- 사용자 테스트
- 패키징 및 배포

## 7. 성공 지표

### 7.1 정량적 지표
- 문서 작성 시간 80% 단축
- 오류율 1% 미만
- 사용자 만족도 90% 이상

### 7.2 정성적 지표
- 직관적이고 쉬운 사용성
- 안정적인 문서 변환
- 한글 깨짐 없는 완벽한 인코딩

## 8. 리스크 및 대응방안

### 8.1 기술적 리스크
- **HWP 포맷 복잡성**: 단계적 기능 구현
- **인코딩 이슈**: 철저한 테스트 및 폴백 메커니즘
- **macOS 권한 문제**: 코드 서명 및 공증

### 8.2 사업적 리스크
- **한컴 라이선스**: 오픈소스 라이브러리 활용
- **사용자 교육**: 상세한 문서 및 튜토리얼 제공

## 9. 참고사항

### 9.1 경쟁 제품
- 한컴오피스 자동화 도구
- MS Word 자동화 솔루션
- 웹 기반 문서 생성 도구

### 9.2 차별화 요소
- MCP 프로토콜 기반 AI 통합
- 로컬 처리로 보안성 확보
- macOS 네이티브 지원
- 오픈소스 기반 확장성

## 10. 연락처 및 담당자
- Product Owner: [담당자명]
- Tech Lead: [담당자명]
- UX Designer: [담당자명]

---

*문서 버전: 1.0*
*작성일: 2025-09-09*
*최종 수정일: 2025-09-09*