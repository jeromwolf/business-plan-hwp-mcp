<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ëª©ì—… ë°ì´í„° í…ŒìŠ¤íŠ¸</title>
    <script src="js/survey-system.js"></script>
    <script src="js/ai-engine.js"></script>
    <script src="templates/prompts.js"></script>
    <script src="js/content-mapper.js"></script>
    <script src="js/ai-automation.js"></script>
    <link rel="stylesheet" href="css/ai-components.css">
</head>
<body>
    <h1>AI ìë™í™” ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸</h1>
    
    <button onclick="testMockGeneration()">ëª©ì—… ë°ì´í„° ìƒì„± í…ŒìŠ¤íŠ¸</button>
    <button onclick="testContentMapping()">ì½˜í…ì¸  ë§¤í•‘ í…ŒìŠ¤íŠ¸</button>
    <button onclick="testFullFlow()">ì „ì²´ í”Œë¡œìš° í…ŒìŠ¤íŠ¸ (ëª©ì—…)</button>
    
    <div id="result" style="margin-top: 20px; padding: 20px; border: 1px solid #ccc; min-height: 200px;">
        ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...
    </div>
    
    <!-- í…ŒìŠ¤íŠ¸ìš© UI í•„ë“œë“¤ -->
    <div id="test-fields" style="margin-top: 20px; padding: 20px; background: #f5f5f5;">
        <h3>í…ŒìŠ¤íŠ¸ í•„ë“œë“¤ (AIê°€ ì±„ìš¸ ì˜ˆì •)</h3>
        <input type="text" id="companyName" placeholder="íšŒì‚¬ëª…" style="width: 200px; margin: 5px;"><br>
        <input type="text" id="ceoName" placeholder="ëŒ€í‘œìëª…" style="width: 200px; margin: 5px;"><br>
        <input type="text" id="foundedDate" placeholder="ì„¤ë¦½ì¼" style="width: 200px; margin: 5px;"><br>
        <input type="text" id="businessItem" placeholder="ì‚¬ì—… ì•„ì´í…œ" style="width: 200px; margin: 5px;"><br>
        <textarea id="businessContent" placeholder="ì‚¬ì—… ë‚´ìš©" style="width: 400px; height: 100px; margin: 5px;"></textarea><br>
        <textarea id="editor-1" placeholder="íšŒì‚¬ ê°œìš”" style="width: 400px; height: 100px; margin: 5px;"></textarea><br>
        <textarea id="editor-2" placeholder="ì‹œì¥ ë¶„ì„" style="width: 400px; height: 100px; margin: 5px;"></textarea>
    </div>
    
    <script>
        // ëª©ì—… ë°ì´í„° ìƒì„± í…ŒìŠ¤íŠ¸
        function testMockGeneration() {
            console.log('ëª©ì—… ë°ì´í„° ìƒì„± í…ŒìŠ¤íŠ¸...');
            const resultDiv = document.getElementById('result');
            
            const testSurveyData = {
                basic: {
                    companyName: 'í…Œí¬ì´ë…¸ë² ì´ì…˜',
                    industry: 'AI/ë¨¸ì‹ ëŸ¬ë‹',
                    stage: 'ì‹œë“œ ë‹¨ê³„'
                },
                business: {
                    problem: 'ì¤‘ì†Œê¸°ì—…ì˜ ë°ì´í„° ë¶„ì„ ì—­ëŸ‰ ë¶€ì¡±',
                    solution: 'No-code AI ë¶„ì„ í”Œë«í¼',
                    targetMarket: 'ì œì¡°ì—… ì¤‘ì†Œê¸°ì—…'
                },
                financial: {
                    fundingNeed: '10ì–µì›'
                }
            };
            
            try {
                // AI ì—”ì§„ìœ¼ë¡œ ëª©ì—… ë°ì´í„° ìƒì„±
                const mockData = aiEngine.generateMockData(testSurveyData);
                console.log('ìƒì„±ëœ ëª©ì—… ë°ì´í„°:', mockData);
                
                resultDiv.innerHTML = `
                    <h3>âœ… ëª©ì—… ë°ì´í„° ìƒì„± ì„±ê³µ!</h3>
                    <p><strong>íšŒì‚¬ëª…:</strong> ${mockData.company}</p>
                    <p><strong>ëŒ€í‘œ:</strong> ${mockData.ceo}</p>
                    <p><strong>ì„¤ë¦½ì¼:</strong> ${mockData.establishDate}</p>
                    <p><strong>ë¹„ì¦ˆë‹ˆìŠ¤ ëª¨ë¸:</strong> ${mockData.businessModel}</p>
                    <p><strong>ìˆ˜ìµ ëª¨ë¸:</strong> ${mockData.revenueModel}</p>
                    <h4>ì„¹ì…˜ ìƒ˜í”Œ:</h4>
                    <p style="background: #f0f0f0; padding: 10px;">${mockData.sections.executive_summary}</p>
                `;
                
                return mockData;
            } catch (error) {
                console.error('ëª©ì—… ìƒì„± ì‹¤íŒ¨:', error);
                resultDiv.innerHTML = `
                    <h3>âŒ ì‹¤íŒ¨</h3>
                    <p>ì—ëŸ¬: ${error.message}</p>
                `;
                return null;
            }
        }
        
        // ì½˜í…ì¸  ë§¤í•‘ í…ŒìŠ¤íŠ¸
        function testContentMapping() {
            console.log('ì½˜í…ì¸  ë§¤í•‘ í…ŒìŠ¤íŠ¸...');
            const resultDiv = document.getElementById('result');
            
            // ë¨¼ì € ëª©ì—… ë°ì´í„° ìƒì„±
            const mockData = testMockGeneration();
            if (!mockData) return;
            
            try {
                // ì½˜í…ì¸  ë§¤í¼ë¡œ UIì— ì ìš©
                const success = populateFormWithAIContent(mockData);
                
                if (success) {
                    resultDiv.innerHTML += `
                        <hr>
                        <h3>âœ… UI ë§¤í•‘ ì„±ê³µ!</h3>
                        <p>í…ŒìŠ¤íŠ¸ í•„ë“œë“¤ì„ í™•ì¸í•´ë³´ì„¸ìš”. AIê°€ ìƒì„±í•œ ë‚´ìš©ì´ ì±„ì›Œì¡ŒìŠµë‹ˆë‹¤.</p>
                    `;
                } else {
                    resultDiv.innerHTML += `
                        <hr>
                        <h3>âš ï¸ UI ë§¤í•‘ ë¶€ë¶„ ì‹¤íŒ¨</h3>
                        <p>ì¼ë¶€ í•„ë“œê°€ ë§¤í•‘ë˜ì§€ ì•Šì•˜ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                    `;
                }
                
                // ë§¤í•‘ ìƒíƒœ í™•ì¸
                const status = contentMapper.getMappingStatus();
                console.log('ë§¤í•‘ ìƒíƒœ:', status);
                
                resultDiv.innerHTML += `
                    <p><strong>ë§¤í•‘ ì™„ë£Œìœ¨:</strong> ${status.completionRate}%</p>
                    <p><strong>ë§¤í•‘ëœ í•„ë“œ:</strong> ${status.mappedFields}/${status.totalFields}</p>
                `;
                
            } catch (error) {
                console.error('ë§¤í•‘ ì‹¤íŒ¨:', error);
                resultDiv.innerHTML += `
                    <hr>
                    <h3>âŒ ë§¤í•‘ ì‹¤íŒ¨</h3>
                    <p>ì—ëŸ¬: ${error.message}</p>
                `;
            }
        }
        
        // ì „ì²´ í”Œë¡œìš° í…ŒìŠ¤íŠ¸ (ëª©ì—… ë°ì´í„° ì‚¬ìš©)
        async function testFullFlow() {
            console.log('ì „ì²´ í”Œë¡œìš° í…ŒìŠ¤íŠ¸ ì‹œì‘...');
            const resultDiv = document.getElementById('result');
            
            resultDiv.innerHTML = '<h3>ğŸ”„ ì „ì²´ í”Œë¡œìš° í…ŒìŠ¤íŠ¸ ì§„í–‰ ì¤‘...</h3>';
            
            // í…ŒìŠ¤íŠ¸ ì„¤ë¬¸ ë°ì´í„°
            const surveyData = {
                basic: {
                    companyName: 'AI ì†”ë£¨ì…˜ì¦ˆ',
                    industry: 'ì¸ê³µì§€ëŠ¥/ë¹…ë°ì´í„°',
                    stage: 'ì´ˆê¸° ìš´ì˜'
                },
                business: {
                    problem: 'ê¸°ì—…ì˜ AI ë„ì… ì¥ë²½ì´ ë†’ìŒ',
                    solution: 'ì‰½ê³  ë¹ ë¥¸ AI ë„ì… ì»¨ì„¤íŒ… ë° ì†”ë£¨ì…˜',
                    targetMarket: 'ì¤‘ê²¬ê¸°ì—… ë° ëŒ€ê¸°ì—…'
                },
                financial: {
                    fundingNeed: '20ì–µì›'
                },
                purpose: {
                    documentPurpose: 'íˆ¬ì ìœ ì¹˜'
                }
            };
            
            try {
                // 1. AI ì½˜í…ì¸  ìƒì„± (ëª©ì—…)
                resultDiv.innerHTML += '<p>1ï¸âƒ£ AI ì½˜í…ì¸  ìƒì„± ì¤‘...</p>';
                const generatedContent = await aiEngine.generateBusinessPlan(surveyData);
                console.log('ìƒì„±ëœ ì½˜í…ì¸ :', generatedContent);
                
                // 2. UIì— ë§¤í•‘
                resultDiv.innerHTML += '<p>2ï¸âƒ£ UIì— ì½˜í…ì¸  ë§¤í•‘ ì¤‘...</p>';
                const mappingSuccess = populateFormWithAIContent(generatedContent);
                
                // 3. ê²°ê³¼ í‘œì‹œ
                if (mappingSuccess) {
                    resultDiv.innerHTML += `
                        <hr>
                        <h3>âœ… ì „ì²´ í”Œë¡œìš° í…ŒìŠ¤íŠ¸ ì„±ê³µ!</h3>
                        <p>AIê°€ ì‚¬ì—…ê³„íšì„œë¥¼ ì„±ê³µì ìœ¼ë¡œ ìƒì„±í•˜ê³  UIì— ì ìš©í–ˆìŠµë‹ˆë‹¤.</p>
                        <h4>ìƒì„±ëœ ë‚´ìš© ìš”ì•½:</h4>
                        <ul>
                            <li>íšŒì‚¬: ${generatedContent.company}</li>
                            <li>ì—…ì¢…: ${surveyData.basic.industry}</li>
                            <li>í•„ìš” ìê¸ˆ: ${surveyData.financial.fundingNeed}</li>
                            <li>ë¬¸ì„œ ìš©ë„: ${surveyData.purpose.documentPurpose}</li>
                        </ul>
                    `;
                } else {
                    throw new Error('UI ë§¤í•‘ ì‹¤íŒ¨');
                }
                
            } catch (error) {
                console.error('ì „ì²´ í”Œë¡œìš° í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨:', error);
                resultDiv.innerHTML += `
                    <hr>
                    <h3>âŒ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨</h3>
                    <p>ì—ëŸ¬: ${error.message}</p>
                    <p>ì½˜ì†”ì—ì„œ ìì„¸í•œ ì—ëŸ¬ë¥¼ í™•ì¸í•˜ì„¸ìš”.</p>
                `;
            }
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ
        window.onload = function() {
            console.log('í…ŒìŠ¤íŠ¸ í˜ì´ì§€ ì¤€ë¹„ ì™„ë£Œ');
            console.log('AI ì—”ì§„:', aiEngine);
            console.log('ì½˜í…ì¸  ë§¤í¼:', contentMapper);
        };
    </script>
</body>
</html>